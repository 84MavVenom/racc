* ensure 'error' token handling
* optimize generator
